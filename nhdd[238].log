
--=[ 2023-02-08 14:21:54.486 ]=--
UnloadThread=128
>>> ************* NT::hook_AcquireCredentialsHandleW
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E7529 nhdll.dll!long NT::hook_AcquireCredentialsHandleW(wchar_t *,wchar_t *,unsigned long,void *,void *,void (*)(void *,void *,unsigned long,void * *,long *),void *,_SecHandle *,_LARGE_INTEGER *) + 2d
>> 00007FFDEBD7BC8C tspkg.DLL!long SpAcquireCredentialsHandle(_UNICODE_STRING *,unsigned long,_LUID *,void *,void *,void *,unsigned __int64 *,_LARGE_INTEGER *) + 28c
>> 00007FFDEC491EBB lsasrv.dll!long WLsaAcquireCredHandle(_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_LUID *,void *,void *,void *,_SecHandle *,_LARGE_INTEGER *) + 237
>> 00007FFDEC49BDCE lsasrv.dll!long SspiExAcquireCredentialsHandle(void *,_CLIENT_ID *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_LUID *,void *,unsigned long,void *,void *,unsigned long,_SecHandle *,_LARGE_INTEGER *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 1ce
>> 00007FFDEB8916CC SspiSrv.dll!SspirAcquireCredentialsHandle + 14c
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_AcquireCredentialsHandleW

>> AcquireCredentialsHandle<H1>("(null)", "Negotiate", 00000201C7E04A70)

<< AcquireCredentialsHandle<H1>("(null)" 00000201C745DA400000000000010069 ) = 0
>>> ************* NT::hook_InitializeSecurityContextW
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E7051 nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 45
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_InitializeSecurityContextW

>> InitializeSecurityContext<I1>( 00000201C745DA400000000000010069 "TERMSRV/WIN-T34PSSK9VQT", 0000000000000000/00000201C7FFFD98 <<000000FB1E2FDED0 000000FB1E2FDEC0>>)
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36640>(00000000000013BC 0)
NT::hook_WSPCloseSocket(File=00000000000013BC)
NT::FO_CTX::~FO_CTX<00000201C7E36640>(00000000000013BC [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36380>(00000000000013BC 0)
NT::hook_WSPConnect(00000000000013BC 192.168.141.129:88)
NT::hook_WSPSend(00000000000013BC)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 4e e1 14 fa a8  15 30 13 02 01 12 02 01   ...N.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=00000000000013BC, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<00000000000013BC>=10054, [0]
NT::hook_WSPCloseSocket(File=00000000000013BC)
NT::FO_CTX::~FO_CTX<00000201C7E36380>(00000000000013BC [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36740>(0000000000000DEC 0)
NT::hook_WSPCloseSocket(File=0000000000000DEC)
NT::FO_CTX::~FO_CTX<00000201C7E36740>(0000000000000DEC [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36280>(0000000000000DEC 0)
NT::hook_WSPConnect(0000000000000DEC 192.168.141.129:88)
NT::hook_WSPSend(0000000000000DEC)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 4e e1 14 fa a8  15 30 13 02 01 12 02 01   ...N.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPSend(0000000000000DEC)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 4e e1 14 fa a8  15 30 13 02 01 12 02 01   ...N.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=0000000000000DEC, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<0000000000000DEC>=10054, [0]
NT::hook_WSPCloseSocket(File=0000000000000DEC)
NT::FO_CTX::~FO_CTX<00000201C7E36280>(0000000000000DEC [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36840>(000000000000121C 0)
NT::hook_WSPCloseSocket(File=000000000000121C)
NT::FO_CTX::~FO_CTX<00000201C7E36840>(000000000000121C [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E363C0>(000000000000121C 0)
NT::hook_WSPConnect(000000000000121C 192.168.141.129:88)
NT::hook_WSPSend(000000000000121C)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 4e e1 14 fa a8  15 30 13 02 01 12 02 01   ...N.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPSend(000000000000121C)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC092152 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 6ab2
>> 00007FFDEC052C33 kerberos.DLL!SpInitLsaModeContext + bf3
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC4DC15F lsasrv.dll!LsarOpenPolicy2_notify + 122ff
>> 00007FFDEC509CCD lsasrv.dll!long NegGenerateInitialToken(unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 51
>> 00007FFDEC4C7061 lsasrv.dll!long NegInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 7c1
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 4e e1 14 fa a8  15 30 13 02 01 12 02 01   ...N.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=000000000000121C, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<000000000000121C>=10054, [0]
NT::hook_WSPCloseSocket(File=000000000000121C)
NT::FO_CTX::~FO_CTX<00000201C7E363C0>(000000000000121C [00007FFDE97E62E2, 0000000000000020])
phNewContext := 00000201C7497C40000000000001006C
PSecBufferDesc<I1>(v=0, n=1) : Output
	BufferType = TOKEN, cb = 28, pv = 00000201C74B17F0

<< InitializeSecurityContext<I1> () = 90312
>>> ************* NT::hook_InitializeSecurityContextW
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E7051 nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 45
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_InitializeSecurityContextW

>> InitializeSecurityContext<I2>( 00000201C745DA400000000000010069 "TERMSRV/WIN-T34PSSK9VQT", 00000201C7FFFD98/00000201C7FFFD98 <<000000FB1E2FDED0 000000FB1E2FDEC0>>)
hContext = 00000201C7497C40000000000001006C
PSecBufferDesc<I2>(v=0, n=1) : Input-
	BufferType = TOKEN, cb = ee, pv = 00000201C7C657D0
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36280>(00000000000013C0 0)
NT::hook_WSPCloseSocket(File=00000000000013C0)
NT::FO_CTX::~FO_CTX<00000201C7E36280>(00000000000013C0 [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E363C0>(00000000000013C0 0)
NT::hook_WSPConnect(00000000000013C0 192.168.141.129:88)
NT::hook_WSPSend(00000000000013C0)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPSend(00000000000013C0)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=00000000000013C0, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<00000000000013C0>=10054, [0]
NT::hook_WSPCloseSocket(File=00000000000013C0)
NT::FO_CTX::~FO_CTX<00000201C7E363C0>(00000000000013C0 [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E363C0>(0000000000001180 0)
NT::hook_WSPCloseSocket(File=0000000000001180)
NT::FO_CTX::~FO_CTX<00000201C7E363C0>(0000000000001180 [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36280>(0000000000001180 0)
NT::hook_WSPConnect(0000000000001180 192.168.141.129:88)
NT::hook_WSPSend(0000000000001180)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPSend(0000000000001180)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=0000000000001180, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<0000000000001180>=10054, [0]
NT::hook_WSPCloseSocket(File=0000000000001180)
NT::FO_CTX::~FO_CTX<00000201C7E36280>(0000000000001180 [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(23-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEF598276 WS2_32.dll!int SortIPAddrs(int,sockaddr_in *,unsigned int,sockaddr_in6 *,unsigned int,unsigned int,_SOCKET_ADDRESS_LIST * *,unsigned int *) + 146
>> 00007FFDEF59573B WS2_32.dll!int LookupAddressForName(unsigned short const *,unsigned short const *,int,int,int,unsigned short,int,int,addrinfoW * * *) + 157
>> 00007FFDEF594304 WS2_32.dll!GetAddrInfoW + 384
>> 00007FFDEC113ED4 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 1b0
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E363C0>(00000000000013C0 0)
NT::hook_WSPCloseSocket(File=00000000000013C0)
NT::FO_CTX::~FO_CTX<00000201C7E363C0>(00000000000013C0 [00007FFDE97E62E2, 0000000000000020])
NT::hook_WSPSocket(2-2-0 1)
>>> ************* NT::hook_WSPSocket
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E62C6 nhdll.dll!hook_WSPSocket + ae
>> 00007FFDEF59A2E9 WS2_32.dll!WSASocketW + 179
>> 00007FFDEF59A105 WS2_32.dll!socket + a5
>> 00007FFDEC113F91 kerberos.DLL!long KerbBindSocketByAddress(_UNICODE_STRING *,unsigned long,unsigned long,unsigned char,unsigned short,unsigned __int64 *) + 26d
>> 00007FFDEC1144CF kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + c7
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSocket
NT::FO_CTX::FO_CTX<00000201C7E36440>(00000000000013C0 0)
NT::hook_WSPConnect(00000000000013C0 192.168.141.129:88)
NT::hook_WSPSend(00000000000013C0)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPSend(00000000000013C0)
>>> ************* NT::hook_WSPSend
>> 00007FFDE97E1D2D nhdll.dll!void NT::DumpStack(unsigned long,char const *,unsigned long (*)(char const *,...)) + 3d
>> 00007FFDE97E60C2 nhdll.dll!hook_WSPSend + 66
>> 00007FFDEF59282F WS2_32.dll!WSASend + 19f
>> 00007FFDEC1146AB kerberos.DLL!long KerbCallKdcEx(_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,unsigned char,unsigned short,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *) + 2a3
>> 00007FFDEC093586 kerberos.DLL!wil::details::`dynamic atexit destructor for 'g_threadFailureCallbacks'' + 7ee6
>> 00007FFDEC0B25AB kerberos.DLL!long KerbMakeSocketCall(_UNICODE_STRING *,_UNICODE_STRING *,_KERB_KDC_TYPE,unsigned char,unsigned char,_KERB_MESSAGE_BUFFER *,_KERB_MESSAGE_BUFFER *,_KERB_BINDING_CACHE_ENTRY *,unsigned long,unsigned char *,_UNICODE_STRING *) + 63
>> 00007FFDEC06CAD6 kerberos.DLL!long KerbGetAuthenticationTicketEx(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,unsigned char,unsigned long,unsigned char *,_KERB_INTERNAL_NAME *,_UNICODE_STRING *,_KERB_INTERNAL_NAME *,unsigned long,unsigned long,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,_UNICODE_STRING *,int *,_KDC_PROXY_CACHE_ENTRY * *) + 1a06
>> 00007FFDEC070FEB kerberos.DLL!long KerbGetTicketGrantingTicket(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,_KERB_ENCRYPTION_KEY *,unsigned char) + 58b
>> 00007FFDEC07FDE3 kerberos.DLL!long KerbGetTicketForCredential(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *) + 35f
>> 00007FFDEC0B2A51 kerberos.DLL!long KerbRefreshPrimaryTgt(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY *,unsigned char) + 135
>> 00007FFDEC0B1DDE kerberos.DLL!long KerbGetTgtForService(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_KERB_EXTRA_CRED *,_KERB_PROXY_LOGON_CRED *,_UNICODE_STRING *,_UNICODE_STRING *,unsigned long,_KERB_TICKET_CACHE_ENTRY * *,unsigned char *) + 3ae
>> 00007FFDEC0FEEA3 kerberos.DLL!long KerbRetrieveSuppCreds(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_SECPKG_SUPPLEMENTAL_CRED_ARRAY * *,_NETLOGON_VALIDATION_SAM_INFO4 * *) + a7
>> 00007FFDEC0FEB1B kerberos.DLL!long KerbRetrieveOWF(_KERB_LOGON_SESSION *,_KERB_CREDENTIAL *,_KERB_CREDMAN_CRED *,_UNICODE_STRING *,_KERB_QUERY_SUPPLEMENTAL_CREDS_RESPONSE * *,unsigned long *) + 87
>> 00007FFDEC0DDC84 kerberos.DLL!long KerbQuerySupplementalCredentials(void * *,void *,void *,unsigned long,void * *,unsigned long *,long *) + 7e4
>> 00007FFDEC0665E4 kerberos.DLL!LsaApCallPackage + a4
>> 00007FFDEC4A0111 lsasrv.dll!LsaICallPackageEx + 111
>> 00007FFDEC513C98 lsasrv.dll!LsaICallPackage + 28
>> 00007FFDEBEFC344 msv1_0.DLL!MsvGetOwfFromCert + 460
>> 00007FFDEBEAC4FD msv1_0.DLL!SsprHandleChallengeMessage + 2e0d
>> 00007FFDEBEA2492 msv1_0.DLL!SpInitLsaModeContext + 8a2
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDEBD31788 SspiCli.dll!DisconnectRpcConnection$filt$1 + 2b0c
>> 00007FFDEBD24C7B SspiCli.dll!long LsaInitializeSecurityContextCommon(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 23b
>> 00007FFDEBD243EA SspiCli.dll!long LsaInitializeSecurityContextW(_SecHandle *,_SecHandle *,unsigned short *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 5a
>> 00007FFDEBD2B607 SspiCli.dll!long InitializeSecurityContextCommon(_SecHandle *,_SecHandle *,void *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char) + 2e7
>> 00007FFDEBD2B1D0 SspiCli.dll!InitializeSecurityContextW + 70
>> 00007FFDE97E719F nhdll.dll!long NT::hook_InitializeSecurityContextW(_SecHandle *,_SecHandle *,wchar_t *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *) + 193
>> 00007FFDEBD81422 tspkg.DLL!long SpInitLsaModeContext(unsigned __int64,unsigned __int64,_UNICODE_STRING *,unsigned long,unsigned long,_SecBufferDesc *,unsigned __int64 *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 842
>> 00007FFDEC490486 lsasrv.dll!long WLsaProcessContext(bool,_SecHandle *,_SecHandle *,_UNICODE_STRING *,_SecBufferDesc *,unsigned long,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + 5a6
>> 00007FFDEC4918C4 lsasrv.dll!long WLsaInitContext(_SecHandle *,_SecHandle *,_UNICODE_STRING *,unsigned long,unsigned long,unsigned long,_SecBufferDesc *,unsigned long,_SecHandle *,_SecBufferDesc *,unsigned long *,_LARGE_INTEGER *,unsigned char *,_SecBuffer *) + cc
>> 00007FFDEC48F71A lsasrv.dll!long SspiExProcessSecurityContext(void *,_CLIENT_ID *,unsigned long *,_UNICODE_STRING *,_SecHandle *,_SecHandle *,unsigned long,unsigned long,unsigned char *,unsigned short *,_SecBufferDesc *,_SecBufferInfoArray *,_SecBufferDesc *,_SecBufferInfoArray * *,_SecBuffer *,_SecHandle *,unsigned long *,_LARGE_INTEGER *,long *,_SECPKG_APP_MODE_INFO *,_SECPKG_APP_MODE_INFO *) + 81a
>> 00007FFDEB89129D SspiSrv.dll!SspirProcessSecurityContext + 28d
>> 00007FFDED815543 RPCRT4.dll!Invoke + 73
>> 00007FFDED882BFA RPCRT4.dll!long Ndr64StubWorker(void *,void *,_RPC_MESSAGE *,_MIDL_SERVER_INFO_ *,long (*const *)(void),_MIDL_SYNTAX_INFO *,unsigned long *) + b8a
>> 00007FFDED7F1C5C RPCRT4.dll!NdrServerCallAll + 3c
>> 00007FFDED7BAFC2 RPCRT4.dll!DispatchToStubInCNoAvrf + 22
>> 00007FFDED7DBE84 RPCRT4.dll!long RPC_INTERFACE::DispatchToStubWorker(_RPC_MESSAGE *,unsigned int,int,long *) + 1b4
>> 00007FFDED7DB861 RPCRT4.dll!long RPC_INTERFACE::DispatchToStub(_RPC_MESSAGE *,unsigned int,int,long *,RPCP_INTERFACE_GROUP *) + f1
>> 00007FFDED7E7844 RPCRT4.dll!long LRPC_SCALL::DispatchRequest(int *) + 324
>> 00007FFDED7E6CE6 RPCRT4.dll!void LRPC_SCALL::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,RPCP_ALPC_HANDLE_ATTR *) + 996
>> 00007FFDED7E6293 RPCRT4.dll!void LRPC_SASSOCIATION::HandleRequest(_PORT_MESSAGE *,_PORT_MESSAGE *,void *,unsigned __int64,int,RPCP_ALPC_TOKEN_ATTR *,RPCP_ALPC_HANDLE_ATTR *,RPCP_ALPC_WORK_ON_BEHALF_ATTR *) + 2c3
>> 00007FFDED7E5EEC RPCRT4.dll!void LRPC_ADDRESS::HandleRequest(_PORT_MESSAGE *,RPCP_ALPC_MESSAGE_ATTRIBUTES *,_PORT_MESSAGE *,int) + 17c
>> 00007FFDED7E5B19 RPCRT4.dll!void LRPC_ADDRESS::ProcessIO(void *) + 939
>> 00007FFDED7E96D9 RPCRT4.dll!void LrpcIoComplete(_TP_CALLBACK_INSTANCE *,void *,_TP_ALPC *,void *) + 109
>> 00007FFDEF69F547 ntdll.dll!TppAlpcpExecuteCallback + 157
>> 00007FFDEF685E8C ntdll.dll!TppWorkerThread + 72c
>> 00007FFDEDA826BD KERNEL32.DLL!BaseThreadInitThunk + 1d
>> 00007FFDEF6ADFB8 ntdll.dll!RtlUserThreadStart + 28
<<<< ************* NT::hook_WSPSend
0000	6a 81 ab 30 81 a8 a1 03  02 01 05 a2 03 02 01 0a   j..0............
0010	a4 81 9b 30 81 98 a0 07  03 05 00 40 80 00 10 a1   ...0.......@....
0020	0f 30 0d a0 03 02 01 01  a1 06 30 04 1b 02 47 78   .0........0...Gx
0030	a2 11 1b 0f 57 49 4e 2d  54 33 34 50 53 53 4b 39   ....WIN-T34PSSK9
0040	56 51 54 a3 24 30 22 a0  03 02 01 02 a1 1b 30 19   VQT.$0".......0.
0050	1b 06 6b 72 62 74 67 74  1b 0f 57 49 4e 2d 54 33   ..krbtgt..WIN-T3
0060	34 50 53 53 4b 39 56 51  54 a5 11 18 0f 39 39 39   4PSSK9VQT....999
0070	39 30 39 31 33 30 32 34  38 30 35 5a a6 11 18 0f   90913024805Z....
0080	39 39 39 39 30 39 31 33  30 32 34 38 30 35 5a a7   99990913024805Z.
0090	06 02 04 69 0a 0e 05 a8  15 30 13 02 01 12 02 01   ...i.....0......
00a0	11 02 01 17 02 01 18 02  02 ff 79 02 01 03         ..........y...
NT::hook_WSPRecvFrom(File=00000000000013C0, Ctx=0000000000000000, fn=0000000000000000)
NT::hook_WSPRecvFrom<00000000000013C0>=10054, [0]
NT::hook_WSPCloseSocket(File=00000000000013C0)
NT::FO_CTX::~FO_CTX<00000201C7E36440>(00000000000013C0 [00007FFDE97E62E2, 0000000000000020])
PSecBufferDesc<I2>(v=0, n=1) : Input+
	BufferType = TOKEN, cb = ee, pv = 00000201C7C657D0

<< InitializeSecurityContext<I2> () = 80090311
DLL_PROCESS_DETACH 0000000000000000
